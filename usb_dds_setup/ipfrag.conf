# ------------------------------
# Custom sysctl settings for throughput
# ------------------------------

# IP fragment reassembly
net.ipv4.ipfrag_time=3
net.ipv4.ipfrag_high_thresh=268435456   # 256 MB
net.ipv4.ipfrag_low_thresh=196608000    # ~187 MB

# Socket buffer limits
net.core.rmem_default=67108864          # 64 MB default receive buffer
net.core.wmem_default=67108864          # 64 MB default send buffer
net.core.rmem_max=2147483647            # 2 GiB max receive buffer (kernel cap)
net.core.wmem_max=2147483647            # 2 GiB max send buffer

# UDP tuning (important for DDS/ROS2)
net.ipv4.udp_rmem_min=16384
net.ipv4.udp_wmem_min=16384
net.ipv4.udp_mem=8388608 12582912 16777216

# Network backlog (queueing packets before the kernel processes them)
net.core.netdev_max_backlog=16384

# File descriptor and mmap limits (avoid exhaustion on high-throughput apps)
fs.file-max=2097152
vm.max_map_count=262144

